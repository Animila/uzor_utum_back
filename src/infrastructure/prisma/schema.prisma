generator client {
	provider = "prisma-client-js"
	output   = "../../../node_modules/.prisma/client"
}

datasource db {
	provider = "postgresql"
	url      = env("DATABASE_URL")
}

model users {
	id          String    @id
	phone       String    @unique
	email       String    @unique
	first_name  String
	last_name   String
	accepted_at Boolean   @default(false)
	created_at  DateTime  @default(now())
	updated_at  DateTime? @default(now())
	role        Roles     @default(user)
	tokens      tokens[]
}

model tokens {
	id           String   @id
	token        Int      @unique
	activated_at Boolean  @default(false)
	created_at   DateTime @default(now())
	user_id      String
	user         users    @relation(fields: [user_id], references: [id], onDelete: Cascade)
}

model categories {
	id       String     @id
	title    String @unique
	products products[]
}

model materials {
	id    String @id
	title String @unique
	products products[]
}

model products {
	id          String     @id
	title       String
	article     String     @unique
	price       Int
	path_images String[]
	description String
	details     String
	delivery    String
	sex					Sex				 @default(all)
	attributes  Json       @db.JsonB
	available   Int        @default(0)
	created_at 	DateTime 	 @default(now())
	updated_at  DateTime	 @default(now())

	category_id String
	category    categories @relation(fields: [category_id], references: [id])
	material_id String
	material    materials  @relation(fields: [material_id], references: [id])

	discounts discounts[]
}

enum Roles {
	user
	moderator
	admin
}

enum Sex {
	male
	female
	all
}

model discounts {
	id String @id
	percentage Float
	start_date DateTime
	end_date DateTime
	activated Boolean @default(false)
	product_id String
	product products @relation(references: [id], fields: [product_id], onDelete: Cascade)
}
